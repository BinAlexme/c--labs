# **ЛАБОРАТОРНАЯ РАБОТА №6**
**“Управление размером рисунка. Прокрутка  изображения."**

### Задание

1. Ввести в меню команду настройки размеров для вновь создаваемых  рисунков. Вызываемая диалоговая панель должна содержать выбор размера (c использованием radio-кнопок) из трех фиксированных вариантов (320x240, 640x480, 800x600), флажок  выбора ручного ввода размера, поля ввода ширины и высоты рисунка в пикселях. Выбор размера не должен изменять размеры уже существующих рисунков, а должен определять размеры рисунков, создаваемых в дальнейшем командой «Новый». 
1. Рисунок должен отображаться и записываться в файл с учетом своего  размера. Фон области формы, находящийся  вне рисунка, должен отображаться светло-серым цветом.  Если при завершении рисования фигуры будет происходить  выход контура фигуры за границы рисунка, соответствующая фигура не должна добавляться к рисунку.
1. Дополнить окна документов полосами прокрутки, обеспечить корректное отображение рисунков при скроллинге.

**Краткая справка**.

Управляющие элементы RadioButton и CheckBox.

Управляющие элементы RadioButton традиционно представлены в виде надписи с точкой, расположенной от них с левой стороны, которые могут быть либо выбраны, либо не выбраны. RadioButton рекомендуется использовать, когда необходимо предоставить пользователю возможность выбора из нескольких взаимоисключающих вариантов.    Для  того чтобы сгруппировать элементы RadioButton в единую логическую единицу, следует использовать управляющий элемент GroupBox. Расположив в форме сначала групповое окно, а затем необходимые элементы RadioButton внутри границ этого группового окна, можно добиться того, что все переключатели будут изменять свое состояние таким образом, что только один из них может быть выбран в рамках данной группы. Если не разместить их внутри группового окна, то это приведет

к тому, что только один из них cможет быть выбран в каждый конкретный момент времени во всей форме.

Управляющий элемент CheckBox традиционно представляет собой надпись с маленьким окошком с флажком, который располагается слева от нее. Этот управляющий элемент следует использовать, когда необходимо предоставить пользователю возможность выбора одной или нескольких возможностей.

### **Свойства управляющего элемента RadioButton**







|Appearance|<p>Управляющий элемент RadioButton может выводиться в виде</p><p>надписи с круглым флажком выбора, расположенным слева,</p><p>в середине или справа от нее, либо в виде стандартной кнопки.</p><p>В последнем случае кнопка выглядит утопленной, если</p><p>она выбрана, и выпуклой — если нет.</p><p></p>|
| :- | :- |
|<p>AutoCheck</p><p></p>|<p>Когда данному свойству присвоено значение true, то в момент</p><p>щелчка мышью на переключателе выводится флажок выбора.</p><p></p>|
|CheckAlign|<p>Позволяет изменять местоположение переключателя.</p><p>Он может располагаться справа, по центру или слева.</p><p>Определяет состояние управляющего элемента.</p>|
|Checked|<p>Его значение</p><p>равно true, если у данного управляющего элемента установлен</p><p>флажок выбора, и false в противном случае.</p><p></p>|











###
### **События управляющего элемента RadioButton**





|Checkchanged|<p>Сообщение о наступлении этого события отправляется в тот момент, когда флажок выбора RadioButton изменяет свое состояние. Если в рамках формы или группового окна существует более одного управляющего элемента RadioButton, то сообщение об этом событии будет отправляться дважды: сначала управляющему элементу, который до этого был выбран и теперь таковым не является, а затем управляющему элементу, который выбран в настоящий момент.</p><p></p>|
| :- | :- |
|Сlick |<p>Сообщение о наступлении этого события отправляется всякий раз, когда происходит щелчок мышью на RadioButton. Это не то же самое, что событие, связанное с изменением состояния управляющего элемента, поскольку щелчок мышью на каком-либо управляющем элементе два или более раз подряд приводит только к однократному изменению свойства "выбрано" — и то только в том случае, если оно не было выбрано до этого.</p><p></p>|










**Свойства управляющего элемента CheckBox**

Свойства и события данного управляющего элемента очень напоминают свойства и события RadioButton, однако они обладают двумя новыми свойствами:




|CheckState|<p>В отличие от RadioButton, CheckBox может находиться</p><p>в одном из трех состояний:</p><p>• Checked (выбрано)</p><p>• Indeterminate (не определено),</p><p>• Unchecked (не выбрано)</p><p>Если состояние окна выбора описывается как indeterminate,</p><p>то окно выбора, соответствующее данной надписи, обычно</p><p>изображается серым цветом, что означает, что текущее значение</p><p>в окне выбора либо недопустимо, либо лишено смысла при данных</p><p>обстоятельствах</p>|
| :- | :- |
|ThreeState|<p>Когда это свойство имеет значение false, то нет возможности</p><p>изменять состояние CheckBox на indeterminate. Хотя при этом</p><p>по-прежнему можно устанавливать данное значение</p><p>программным путем.</p><p></p>|









**Управляющий элемент Textbox**

Управляющие элементы типа Textbox (текстовое окно) предназначены для ввода пользователем текста. Класс TextBox обеспечивает ряд возможностей по работе с текстом в текстовом окне, такие как выделение текста, вырезание и вставка текста, а также набор событий. 

**Свойства управляющего элемента Textbox**

|Causesvalidation|<p>Когда элемент, у которого данному свойству присвоено</p><p>значение true, должен оказаться в фокусе, то генерируются</p><p>два события — Validating и Validated. Их можно</p><p>обработать с целью проверки допустимости данных,</p><p>введенных в управляющий элемент, который выходит</p><p>из фокуса. </p>|
| - | :- |
|CharacterCasing|<p>Позволяет определить, производится ли изменение регистра</p><p>вводимых символов. Это свойство может иметь одно из трех</p><p>значений:</p><p>• Lower — весь вводимый в окно текст переводится</p><p>в нижний регистр.</p><p>• Normal — текст остается без изменений.</p><p>• Upper — весь вводимый в окно текст переводится</p><p>В верхний регистр</p>|
|MaxLength|<p>Значение, которое определяет максимальную длину текста</p><p>в Textbox, выраженную в символах. Если длина ограничена</p><p>только объемом имеющейся в наличии памяти, данному</p><p>свойству следует присвоить значение, равное нулю.</p><p></p>|
|Multiline|<p>Указывает, допускает ли данный управляющий элемент</p><p>наличие нескольких строк. Многострочный элемент позволяет</p><p>одновременный вывод нескольких строк текста.</p>|
|PasswordChar|<p>Указывает, что текст, находящийся в однострочном окне,</p><p>должен заменяться на "секретные" символы. Если свойство</p><p>Multiline имеет значение, равное true, то это свойство</p><p>игнорируется.</p>|
|<p>Readonly</p><p></p>|<p>Логическое значение, указывающее на то, что текст может</p><p>использоваться в режиме "только чтение".</p>|
|ScrollBars|<p>Позволяет указать, что состоящее из нескольких строк окно</p><p>должно выводиться с линейками прокрутки.</p>|
|SelectedText|Определяет выбранный в окне текст.|
|SelectionLength|Определяет число символов в выбранном тексте.|
|SelectionStart|Определяет начало выделенного текста в текстовом окне.|
|SelectionLength|Определяет число символов в выбранном тексте.|


**События управляющего злемента Textbox**

Управляющий элемент Textbox поддерживает обработку событий, позволяющих организовать  проверку допустимости вводимого текста. Если требуется гарантированно не допускать ввода неверных символов или если нужно, чтобы вводимое в текстовое окно значение находилось в допустимом диапазоне, то необходимо указать пользователю этого управляющего элемента, является ли введенное значение допустимым или нет.

Управляющий элемент Textbox предоставляет следующие события :

|<p>Enter</p><p>GotFocus</p><p>Leave</p><p>Validating</p><p>Validated</p><p>LostFocus</p>|Первые шесть событий, приведенных в таблице наступают в той последовательности, в которой они перечислены. Они известны под названием "событий, связанных с фокусом" и генерируются при любом изменении фокуса управляющего элемента за исключением двух случаев. События Validating и validated происходят только в том случае, если свойство CausesValidation имеет значение true.|
| :- | :- |
|<p>KeyDown</p><p>KeyPress</p><p>KeyUp</p>|<p>Группа событий, связанных с клавишами.</p><p>Они позволяют отслеживать и изменять то, что в вводится в управляющий элемент.</p><p>События KeyDown и КеyUр получают код, соответствующий нажатой клавише. Это позволяет определять нажатие специальных клавиш, например *Shift* или C*trl,* в том числе,  в комбинации с другими клавишами.</p><p>KeyPress позволяет получать символ, соответствующий нажатой клавише.  Это событие оказывается полезным, если требуется задать множество допустимых символов, например, разрешить ввод только численных значений.</p>|
|Change|Наступает при любых изменениях текста в текстовом окне независимо от их характера.|







**Полосы прокрутки (scroll bars).** 

Класс ScrollableControl, производным от которого является класс Form,  предназначен для обеспечения поддержки вертикальной и горизонтальной полос прокрутки. 

Наиболее часто используемыми  свойствами этого класса являются AutoScroll и AutoScrollMinSize. Эти свойства обеспечивают автоматическое появление полос прокрутки в тех ситуациях, когда ее содержимое не умещается в границах формы (например, если пользователь уменьшил ее размер). Свойство AutoScrollMinSize позволяет задать минимальный размер формы, при котором всегда будут появляться полосы прокрутки. Выглядеть это может так:

// Этот код помещается в конструктор класса или метод InitializeComponent().

tnis.AutoScroll = true;

this.AutoScrollMinSize = new System.Drawing.Size (300, 300);

После этого класс ScrollableControl обеспечит появление полос прокрутки и обработку событий прокрутки.

***Рекомендации***

Пункт 1. 

В диалоговой панели выбора размера  рисунка следует использовать следующие элементы  панели «Toolbox»:  Button, RadioButton, GroupBox, CheckBox, TextBox. Кнопке «OK» следует задать значение «OK» свойства DialogResult, кнопке «Cancel» - значение  «Cancel». Следует добавить в класс этой диалоговой панели public поле типа Size, которое будет сохранять заданный размер рисунка, и обработчик щелчка по кнопке “OK”, который должен считывать из элементов панели заданный размер (с учётом состояния флажка ручного ввода размера) и сохранять его в указанной переменной.

Реализовать  обработчик события CheckedChanged  (изменение состояния флажка ручного ввода размера), в котором через свойство Enabled элементов GroupBox и TextBox следует управлять доступностью этих элементов для ввода и выбора в соответствии с состоянием флажка.

Обработчик соответствующей команды меню в классе Form1 должен создавать диалоговую панель выбора размера и считывать  после её закрытия результат выбора пользователя.

Пункт 2. 

При создании новых окон рисунков следует задавать для них размер рисунка и учитывать его при выполнении операций с рисунком. Для этого надо добавить соответствующее поле к классу формы рисунка и реализовать конструктор этого класса, получающий в качестве аргумента размер рисунка.  Этот конструктор должен вызываться из обработчика команды меню,  создающей новое окно.

Для цвета нерабочей области окна  рисунка (фон формы) в свойствах формы следует задать серый цвет (например, ControlDark).

Обработчик события Paint должен перед рисованием  фигур рисунка заполнять рабочую область окна рисунка белым цветом (метод FillRectangle). 

Обработчик отпускания кнопки мыши должен проверять условие попадания создаваемой фигуры в область рисунка  и добавлять к рисунку только те фигуры, которые соответствуют этому условию.

При сохранении рисунка в файлах и чтении из файлов операции сериализации/десериализации массива фигур должны дополниться соответствующими действиями с размером рисунка.

Пункт 3. 

Для обеспечения обработки скроллинга следует установить в true свойство  формы AutoScroll и задавать в конструкторе формы значение свойству AutoScrollMinSize, которое должно соответствовать размеру рабочей области окна рисунка. 

При создании объектов фигур и их рисовании теперь следует учитывать, что в окнах со скроллингом координаты мыши, передаваемые обработчикам событий,  и координаты, передаваемые методам  класса Graphics, отсчитываются от левого верхнего угла видимой области окна, а не от  левого верхнего угла рисунка, отображаемого в окне. Следовательно, координаты, отсчитываемые от верхнего левого угла полного рисунка, должны формироваться из оконных координат в результате их модификации на величину смещения, задаваемого полосами прокрутки. Эта величина доступна через свойство формы AutoScrollPosition, хранящее отрицательные значения ненулевых смещений видимой области рисунка по осям X и Y. Соответствующий параметр, позволяющий учесть смещение при скроллинге,  потребуется добавить к методам рисования фигур для их корректного отображения в окнах со скроллингом.

